/** * ... * XMLParser, versión AS3 * Parseador de un fichero XML. * Segun la aplicacion en cuestion, se utiliza para convertir un fichero XML de configuracion, en objetos contenedores de datos (VOs) *  * @author Ernesto Pino Martínez * @date 12/09/2010 */package com.epinom.vetusta.musicexperience.utils{	import com.epinom.vetusta.musicexperience.vos.AuthorVO;	import com.epinom.vetusta.musicexperience.vos.ComponentVO;	import com.epinom.vetusta.musicexperience.vos.LocationVO;	import com.epinom.vetusta.musicexperience.vos.OwnerVO;	import com.epinom.vetusta.musicexperience.vos.ResolutionVO;	import com.epinom.vetusta.musicexperience.vos.SettingsVO;	import com.epinom.vetusta.musicexperience.vos.SoundVO;		public class XMLParser	{		public function XMLParser() {}				public static function parseSettingsXML(settingsXML:XML, currentSettings:SettingsVO = null):SettingsVO		{			trace("XMLParser->parseSettingsXML()");			//trace("XML: ", settingsXML);						// Instanciando objeto de datos para configuracion			var settings:SettingsVO = currentSettings ? currentSettings : new SettingsVO();						// Almacenando valores obtenidos del fichero de configuracion			settings.appName = String(settingsXML.appName);			settings.version = String(settingsXML.version);							// Creando objeto de datos y almacenando valores			var author:AuthorVO = new AuthorVO();			author.name = String(settingsXML.author.name);			author.lastname = String(settingsXML.author.lastname);			author.alias = String(settingsXML.author.alias);			author.email = String(settingsXML.author.email);			author.web = String(settingsXML.author.web);						// Asignando objeto de datos al objeto de configuracion principal			settings.author = author;						// Creando objeto de datos y almacenando valores			var owner:OwnerVO = new OwnerVO();			owner.name = String(settingsXML.owner.name);			owner.web = String(settingsXML.owner.web);						// Asignando objeto de datos al objeto de configuracion principal			settings.owner = owner;						// Creando objeto de datos y almacenando valores			var resolution:ResolutionVO = new ResolutionVO();			resolution.width = Number(settingsXML.resolution.@width);			resolution.height = Number(settingsXML.resolution.@height);						// Asignando objeto de datos al objeto de configuracion principal			settings.resolution = resolution;						// Recorriendo seciones en fichero de configuracion y contruyendo objetos de datos 			var soundXMLList:XMLList = settingsXML.sounds;			for each(var sound:XML in soundXMLList.elements())			{				// Creando objeto de datos y almacenando valores				var soundVO:SoundVO = new SoundVO();				soundVO.id = uint(sound.@id);				soundVO.url = String(sound.@url);								// Adicionando objeto de datos a la lista de secciones del objeto de configuracion principal				settings.soundList.push(soundVO);			}						trace("Cantidad de sonidos cargados: ", settings.soundList.length);			// Recorriendo componentes en fichero de configuracion y contruyendo objetos de datos 			var componentXMLList:XMLList = settingsXML.components;			for each(var c:XML in componentXMLList.elements())			{				// Creando objeto de datos y almacenando valores				var component:ComponentVO = new ComponentVO();				component.type = String(c.type);				component.className = String(c.className);				component.instanceName = String(c.instanceName);				component.visible = StringUtils.stringToBoolean(c.visible);				component.hashId = String(c.hashId);				component.url = String(c.url);				component.changeSize = StringUtils.stringToBoolean(c.changeSize);				component.percentageWidth = Number(c.percentageWidth);				component.percentageHeight = Number(c.percentageHeight);				component.changePositionX = StringUtils.stringToBoolean(c.changePositionX);				component.changePositionY = StringUtils.stringToBoolean(c.changePositionY);				component.percentageX = Number(c.percentageX);				component.percentageY = Number(c.percentageY);				component.centralReference = StringUtils.stringToBoolean(c.centralReference);				component.elementOrder = Number(c.elementOrder);				component.yPosition = Number(c.yPosition);				component.percentagePadding = StringUtils.stringToBoolean(c.percentagePadding);				component.paddingTop = Number(c.paddingTop);				component.paddingBottom = Number(c.paddingBottom);				component.paddingLeft = Number(c.paddingLeft);				component.paddingRight = Number(c.paddingRight);								// Adicionando objeto de datos a la lista de componentes del objeto de configuracion principal				settings.componentVOList.push(component);			}						return settings;			}				public static function parseLocationsXML(locationsXML:XML):Array		{			trace("XMLParser->parseLocationsXML()");			trace("XML: ", locationsXML);						// Creando lista de localizaciones			var locations:Array = new Array();						// Recorriendo seciones en fichero de configuracion y contruyendo objetos de datos 			var locationXMLList:XMLList = locationsXML.locations;			for each(var item:XML in locationXMLList.elements())			{				// Creando objeto de datos y almacenando valores				var locationVO:LocationVO = new LocationVO();				locationVO.id = uint(item.id);				locationVO.fbuid = String(item.fbuid);				locationVO.userName = String(item.user_name);				locationVO.imageName = String(item.user_image);				locationVO.message = String(item.text);				locationVO.world = String(item.world);				locationVO.idCell = String(item.zone);				locationVO.trackIndex = uint(item.song);				locationVO.globalX = Number(item.global_x);				locationVO.globalY = Number(item.global_y);				locationVO.localX = Number(item.local_x);				locationVO.localY = Number(item.local_y);				//locationVO.createdDate = new Date(item.created);								// Adicionando objeto de datos a la lista de secciones del objeto de configuracion principal				locations.push(locationVO);			}						trace("Cantidad de localizaciones cargados: ", locations.length);						return locations;			}	}}